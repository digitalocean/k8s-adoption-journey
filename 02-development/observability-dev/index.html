<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Hands-on tutorial for going from day-1 to production on DigitalOcean Kubernetes." name=description><link href=https://digitalocean.github.io/k8s-adoption-journey/02-development/observability-dev/ rel=canonical><link href=../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.4.0, mkdocs-material-8.5.8" name=generator><title>Observability - Kubernetes Adoption Journey</title><link href=../../assets/stylesheets/main.20d9efc8.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.815d1a91.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent data-md-color-primary data-md-color-scheme=default dir=ltr> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#introduction> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label="Kubernetes Adoption Journey" class="md-header__button md-logo" data-md-component=logo href=../.. title="Kubernetes Adoption Journey"> <img alt=logo src=../../assets/do_logo.png> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Kubernetes Adoption Journey </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Observability </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary data-md-color-scheme=default id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_2 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary data-md-color-scheme=slate id=__palette_2 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/digitalocean/k8s-adoption-journey title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="Kubernetes Adoption Journey" class="md-nav__button md-logo" data-md-component=logo href=../.. title="Kubernetes Adoption Journey"> <img alt=logo src=../../assets/do_logo.png> </a> Kubernetes Adoption Journey </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/digitalocean/k8s-adoption-journey title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../..> Intro </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2> Getting started <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Getting started" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../01-getting-started/installing-required-tools/ class=md-nav__link> Installing required tools </a> </li> <li class=md-nav__item> <a href=../../01-getting-started/do-api-auth/ class=md-nav__link> Authenticating with the DigitalOcean API </a> </li> <li class=md-nav__item> <a href=../../01-getting-started/setup-docr/ class=md-nav__link> Set up a Digital Ocean container registry </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 id=__nav_2_4 type=checkbox> <label class=md-nav__link for=__nav_2_4> Preparing the demo application <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Preparing the demo application" class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Preparing the demo application </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../01-getting-started/building-and-pushing-docker-images/introduction-and-repository-setup/ class=md-nav__link> Repository setup </a> </li> <li class=md-nav__item> <a href=../../01-getting-started/building-and-pushing-docker-images/building-and-pushing-images-using-docker/ class=md-nav__link> Building and pushing images with Docker </a> </li> <li class=md-nav__item> <a href=../../01-getting-started/building-and-pushing-docker-images/building-and-pushing-images-using-cnb/ class=md-nav__link> Building and pushing images with Cloud Native Buildpacks </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3> Development environment <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Development environment" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Development environment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../setup-doks-dev/ class=md-nav__link> Set up Development DOKS </a> </li> <li class=md-nav__item> <a href=../tilt-local/ class=md-nav__link> Tilt for local development </a> </li> <li class=md-nav__item> <a href=../tilt-remote/ class=md-nav__link> Tilt for remote development </a> </li> <li class=md-nav__item> <a href=../setup-ingress-dev/ class=md-nav__link> Set up ingress </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> Observability <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Observability </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#introduction> Introduction </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#prerequisites> Prerequisites </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#installing-the-kubernetes-metrics-server> Installing the Kubernetes Metrics Server </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#collect-resource-metrics-from-kubernetes-objects> Collect resource metrics from Kubernetes objects </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#installing-the-kubernetes-dashboard> Installing the Kubernetes Dashboard </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4> Staging environment <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Staging environment" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Staging environment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../03-staging/setup-doks-staging/ class=md-nav__link> Set up Staging DOKS </a> </li> <li class=md-nav__item> <a href=../../03-staging/deploying-the-online-boutique-sample-application-staging/ class=md-nav__link> Deploying the online boutique sample application </a> </li> <li class=md-nav__item> <a href=../../03-staging/setup-ingress-staging/ class=md-nav__link> Set up ingress </a> </li> <li class=md-nav__item> <a href=../../03-staging/observability-staging/ class=md-nav__link> Observability </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 id=__nav_5 type=checkbox> <label class=md-nav__link for=__nav_5> Production environment <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Production environment" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Production environment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../04-production/setup-doks-production/ class=md-nav__link> Set up Production DOKS </a> </li> <li class=md-nav__item> <a href=../../04-production/deploying-the-online-boutique-sample-application-production/ class=md-nav__link> Deploying the online boutique sample application </a> </li> <li class=md-nav__item> <a href=../../04-production/setup-ingress-production/ class=md-nav__link> Set up ingress </a> </li> <li class=md-nav__item> <a href=../../04-production/observability-production/ class=md-nav__link> Observability </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 id=__nav_6 type=checkbox> <label class=md-nav__link for=__nav_6> Continuous integration and deployments <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Continuous integration and deployments" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Continuous integration and deployments </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../05-ci-cd/setup-continuous-integration/ class=md-nav__link> Set up continuous integration </a> </li> <li class=md-nav__item> <a href=../../05-ci-cd/setup-continuous-deployments/ class=md-nav__link> Set up continuous deployments </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 id=__nav_7 type=checkbox> <label class=md-nav__link for=__nav_7> Promote releases <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Promote releases" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Promote releases </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../06-promote-releases/setup-release-process/ class=md-nav__link> Set up release process </a> </li> <li class=md-nav__item> <a href=../../06-promote-releases/promote-releases-to-upper-envs/ class=md-nav__link> Promote releases to upper environments </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 id=__nav_8 type=checkbox> <label class=md-nav__link for=__nav_8> Security <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=Security class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../07-security/software-supply-chain/ class=md-nav__link> Securing the software supply chain </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#introduction> Introduction </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#prerequisites> Prerequisites </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#installing-the-kubernetes-metrics-server> Installing the Kubernetes Metrics Server </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#collect-resource-metrics-from-kubernetes-objects> Collect resource metrics from Kubernetes objects </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#installing-the-kubernetes-dashboard> Installing the Kubernetes Dashboard </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href=https://github.com/digitalocean/k8s-adoption-journey/edit/master/docs/02-development/observability-dev.md title="Edit this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg> </a> <h1>Observability</h1> <h2 id=introduction>Introduction</h2> <div class="admonition note"> <p class=admonition-title>Note<p>You will not install a full blown monitoring and logging solution on the development cluster such as <code>Prometheus</code> and <code>Loki</code>, but will do so for the <code>staging</code> and <code>production</code> clusters.</p> </p> </div> <p>On the development environment you will be configuring the <code>Kubernetes Metrics Server</code> and <code>Kubernetes Dashboard</code> tools. This way your cluster size can be small but sufficient that you can do your local development and deploy that to a Kubernetes cluster and test it. At the most basic level you will need to be able to troubleshoot your aplication if things go wrong. In this section, you will learn about the <a href=https://github.com/kubernetes-sigs/metrics-server>Kubernetes Metrics Server</a> and the <a href=https://github.com/kubernetes/dashboard>Kubernetes Dashboard</a>. Metrics Server is a scalable, efficient source of container resource metrics for Kubernetes built-in autoscaling pipelines. It collects resource metrics from Kubelets and exposes them in Kubernetes apiserver through <a href=https://github.com/kubernetes/metrics>Metrics API</a>. Kubernetes Dashboard is a general purpose, web-based UI for Kubernetes clusters. It allows users to manage applications running in the cluster and troubleshoot them, as well as manage the cluster itself.</p> <h2 id=prerequisites>Prerequisites</h2> <p>To complete this section you will need:</p> <ol> <li>Helm installed as explained in the <a href=../../01-getting-started/installing-required-tools/ >Installing required tools</a> section.</li> <li>A Kubernetes cluster (DOKS) up and running as explained in the <a href=../setup-doks-dev/ >Set up DOKS</a> section.</li> <li><a href=https://stedolan.github.io/jq/ >JQ</a> command-line JSON processor installed on your machine.</li> <li>The online boutique sample application deployed to your cluster as explained in the <a href=../tilt-remote/ >Tilt remote development</a> section.</li> </ol> <h2 id=installing-the-kubernetes-metrics-server>Installing the Kubernetes Metrics Server</h2> <p>In this section you will install the community maintained Kubernetes Metrics Server. Please follow below steps to install it using Helm:</p> <ol> <li> <p>Add the Metrics Server <code>Helm</code> repository:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a>helm repo add metrics-server https://kubernetes-sigs.github.io/metrics-server/
</code></pre></div> </li> <li> <p>Install the <code>Kubernetes Metrics Server</code> using <code>Helm</code>:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a>helm upgrade --install metrics-server metrics-server/metrics-server <span class=se>\</span>
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a>    --namespace metrics-server <span class=se>\</span>
<a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a>    --create-namespace
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>To check if the installation was successful, run the <code>helm ls -n metrics-server</code> command, and confirm the deployment status.</p> </div> </li> </ol> <h2 id=collect-resource-metrics-from-kubernetes-objects>Collect resource metrics from Kubernetes objects</h2> <p>Resource metrics track the utilization and availability of critical resources such as CPU, memory, and storage. Kubernetes provides a Metrics API and a number of command line queries that allow you to retrieve snapshots of resource utilization.</p> <p>Query the Metrics API to retrieve current metrics from any node or pod (you can find your desired node or pod by running <code>kubectl get nodes</code> or <code>kubectl get pods</code>):</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a>kubectl get --raw /apis/metrics.k8s.io/v1beta1/nodes/&lt;NODE_NAME&gt; <span class=p>|</span> jq
<a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a>
<a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a>kubectl get --raw /apis/metrics.k8s.io/v1beta1/namespaces/&lt;NAMESPACE&gt;/pods/&lt;POD_NAME&gt; <span class=p>|</span> jq
</code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>The Metrics API returns a JSON object, so (optionally) piping the response through jq displays the JSON in a more human-readable format.</p> </div> <p>Retrieve compact metric snapshots from the Metrics API using kubectl top. The <code>kubectl top</code> command returns current CPU and memory usage for a cluster’s pods or nodes, or for a particular pod or node if specified.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a>kubectl top node
</code></pre></div> <p>The output should look like the following:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>NAME            CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   
<a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>basicnp-766qo   280m         7%     1662Mi          24%       
<a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>basicnp-766qr   252m         6%     1561Mi          23%
</code></pre></div> <p>Or you can query resource utilization by pod in a particular namespace (you can use the <code>microservices-demo-dev</code> namespace you deployed in the <a href=../tilt-remote/ >Tilt Remote</a> section):</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a>kubectl top pod --namespace microservices-demo-dev
</code></pre></div> <p>The output should look like the following:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a>NAME                                     CPU(cores)   MEMORY(bytes)   
<a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a>cartservice-84758f76f-cl9vm              8m           29Mi            
<a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a>checkoutservice-5d8d8cfd5f-8hbjn         3m           16Mi            
<a href=#__codelineno-6-4 id=__codelineno-6-4 name=__codelineno-6-4></a>currencyservice-5d5f698f87-kh4z8         4m           30Mi            
<a href=#__codelineno-6-5 id=__codelineno-6-5 name=__codelineno-6-5></a>emailservice-f8795cc94-r7hwp             30m          40Mi            
<a href=#__codelineno-6-6 id=__codelineno-6-6 name=__codelineno-6-6></a>frontend-6d45d8cc5d-59fmw                1m           20Mi            
<a href=#__codelineno-6-7 id=__codelineno-6-7 name=__codelineno-6-7></a>paymentservice-995d69494-kcqn2           5m           30Mi            
<a href=#__codelineno-6-8 id=__codelineno-6-8 name=__codelineno-6-8></a>productcatalogservice-556d4f9446-7sqp9   7m           16Mi            
<a href=#__codelineno-6-9 id=__codelineno-6-9 name=__codelineno-6-9></a>recommendationservice-59f78c445b-5487v   40m          40Mi            
<a href=#__codelineno-6-10 id=__codelineno-6-10 name=__codelineno-6-10></a>redis-cart-596c7658c4-lwf8g              3m           7Mi             
<a href=#__codelineno-6-11 id=__codelineno-6-11 name=__codelineno-6-11></a>shippingservice-bfc488696-dkcpz          3m           15Mi 
</code></pre></div> <p>See details about the resources that have been allocated to your nodes, rather than the current resource usage. The kubectl describe command provides a detailed breakdown of a specified pod or node.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a>kubectl describe node &lt;NODE_NAME&gt;
</code></pre></div> <p>The output is quite verbose containing a full breakdown of the node’s workloads, system info, and metadata such as labels and annotations.</p> <details class=note> <summary>Click to expand <code>node describe command</code> output</summary> <div class=highlight><pre><span></span><code>Name:               basicnp-766qo
Roles:              &lt;none&gt;
Labels:             beta.kubernetes.io/arch=amd64
                    beta.kubernetes.io/instance-type=s-4vcpu-8gb-amd
                    beta.kubernetes.io/os=linux
                    doks.digitalocean.com/node-id=018db650-0dd3-4e23-a387-d386a193456e
                    doks.digitalocean.com/node-pool=basicnp
                    doks.digitalocean.com/node-pool-id=45a15812-c08d-48f0-ae7d-61eb0ddc3e7c
                    doks.digitalocean.com/version=1.24.4-do.0
                    failure-domain.beta.kubernetes.io/region=nyc1
                    kubernetes.io/arch=amd64
                    kubernetes.io/hostname=basicnp-766qo
                    kubernetes.io/os=linux
                    node.kubernetes.io/instance-type=s-4vcpu-8gb-amd
                    region=nyc1
                    topology.kubernetes.io/region=nyc1
                    type=basic
Annotations:        alpha.kubernetes.io/provided-node-ip: 10.116.0.4
                    csi.volume.kubernetes.io/nodeid: {"dobs.csi.digitalocean.com":"318312990"}
                    io.cilium.network.ipv4-cilium-host: 10.244.1.102
                    io.cilium.network.ipv4-health-ip: 10.244.1.76
                    io.cilium.network.ipv4-pod-cidr: 10.244.1.0/25
                    node.alpha.kubernetes.io/ttl: 0
                    volumes.kubernetes.io/controller-managed-attach-detach: true
CreationTimestamp:  Mon, 26 Sep 2022 11:48:39 +0300
Taints:             &lt;none&gt;
Unschedulable:      false
Lease:
HolderIdentity:  basicnp-766qo
AcquireTime:     &lt;unset&gt;
RenewTime:       Wed, 28 Sep 2022 11:31:13 +0300
Conditions:
Type                 Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
----                 ------  -----------------                 ------------------                ------                       -------
NetworkUnavailable   False   Mon, 26 Sep 2022 11:50:10 +0300   Mon, 26 Sep 2022 11:50:10 +0300   CiliumIsUp                   Cilium is running on this node
MemoryPressure       False   Wed, 28 Sep 2022 11:26:35 +0300   Mon, 26 Sep 2022 11:48:39 +0300   KubeletHasSufficientMemory   kubelet has sufficient memory available
DiskPressure         False   Wed, 28 Sep 2022 11:26:35 +0300   Mon, 26 Sep 2022 11:48:39 +0300   KubeletHasNoDiskPressure     kubelet has no disk pressure
PIDPressure          False   Wed, 28 Sep 2022 11:26:35 +0300   Mon, 26 Sep 2022 11:48:39 +0300   KubeletHasSufficientPID      kubelet has sufficient PID available
Ready                True    Wed, 28 Sep 2022 11:26:35 +0300   Mon, 26 Sep 2022 11:49:10 +0300   KubeletReady                 kubelet is posting ready status. AppArmor enabled
Addresses:
InternalIP:  10.116.0.4
Hostname:    basicnp-766qo
ExternalIP:  159.223.163.15
Capacity:
cpu:                4
ephemeral-storage:  165089200Ki
hugepages-1Gi:      0
hugepages-2Mi:      0
memory:             8149728Ki
pods:               110
Allocatable:
cpu:                3900m
ephemeral-storage:  152146206469
hugepages-1Gi:      0
hugepages-2Mi:      0
memory:             6694Mi
pods:               110
System Info:
Machine ID:                 a6b0d5360452428382d5b0c516caa546
System UUID:                a6b0d536-0452-4283-82d5-b0c516caa546
Boot ID:                    3345884c-f9af-4716-af86-17814d28ef96
Kernel Version:             5.10.0-0.bpo.15-amd64
OS Image:                   Debian GNU/Linux 10 (buster)
Operating System:           linux
Architecture:               amd64
Container Runtime Version:  containerd://1.4.13
Kubelet Version:            v1.24.4
Kube-Proxy Version:         v1.24.4
ProviderID:                   digitalocean://318312990
Non-terminated Pods:          (15 in total)
Namespace                   Name                                         CPU Requests  CPU Limits  Memory Requests  Memory Limits  Age
---------                   ----                                         ------------  ----------  ---------------  -------------  ---
cert-manager                cert-manager-ddd4d6ddf-zmpk4                 0 (0%)        0 (0%)      0 (0%)           0 (0%)         47h
ingress-nginx               ingress-nginx-controller-778667bc4b-7lj4c    100m (2%)     0 (0%)      90Mi (1%)        0 (0%)         47h
kube-system                 cilium-bv8x9                                 310m (7%)     100m (2%)   310Mi (4%)       75Mi (1%)      47h
kube-system                 cilium-operator-6d485f4f69-fsv7x             100m (2%)     0 (0%)      150M (2%)        150M (2%)      47h
kube-system                 coredns-9c8d9dc8c-9mzcd                      100m (2%)     0 (0%)      150M (2%)        150M (2%)      47h
kube-system                 cpc-bridge-proxy-dktvq                       100m (2%)     0 (0%)      75Mi (1%)        0 (0%)         47h
kube-system                 csi-do-node-trfdm                            0 (0%)        0 (0%)      0 (0%)           0 (0%)         47h
kube-system                 do-node-agent-vt9kn                          102m (2%)     102m (2%)   80Mi (1%)        300Mi (4%)     47h
kube-system                 konnectivity-agent-fnvp9                     0 (0%)        0 (0%)      0 (0%)           0 (0%)         47h
kube-system                 kube-proxy-9ff7c                             0 (0%)        0 (0%)      125Mi (1%)       0 (0%)         47h
microservices-demo-dev      cartservice-84758f76f-cl9vm                  200m (5%)     300m (7%)   128Mi (1%)       256Mi (3%)     45h
microservices-demo-dev      frontend-6d45d8cc5d-59fmw                    100m (2%)     200m (5%)   64Mi (0%)        128Mi (1%)     45h
microservices-demo-dev      productcatalogservice-556d4f9446-7sqp9       100m (2%)     200m (5%)   64Mi (0%)        128Mi (1%)     45h
microservices-demo-dev      recommendationservice-59f78c445b-5487v       100m (2%)     200m (5%)   220Mi (3%)       450Mi (6%)     45h
microservices-demo-dev      redis-cart-596c7658c4-lwf8g                  70m (1%)      125m (3%)   200Mi (2%)       256Mi (3%)     45h
Allocated resources:
(Total limits may be over 100 percent, i.e., overcommitted.)
Resource           Requests          Limits
--------           --------          ------
cpu                1382m (35%)       1227m (31%)
memory             1721869056 (24%)  1970381568 (28%)
ephemeral-storage  0 (0%)            0 (0%)
hugepages-1Gi      0 (0%)            0 (0%)
hugepages-2Mi      0 (0%)            0 (0%)
</code></pre></div> </details> <h2 id=installing-the-kubernetes-dashboard>Installing the Kubernetes Dashboard</h2> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The <code>Kubernetes Dashboard</code> is already available as a managed solution for DigitalOcean customers after creating a Kubernetes Cluster. You are installing it separately due to the lack of <code>CPU</code> and <code>memory usage</code> metrics not displayed in the managed solution and those metrics are very important to monitor. Please see this <a href=https://docs.digitalocean.com/support/why-are-cpu-and-memory-usage-not-displayed-on-managed-kubernetes-dashboard/ >support case</a> for more details.</p> </div> <p>In this section you will install the community maintained <a href=https://github.com/kubernetes/dashboard>Kubernetes Dashboard</a>. Please follow below steps to install it using kubectl:</p> <ol> <li> <p>Install the <code>Kubernetes Dashboard</code> using <code>kubectl</code>:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a>kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.6.1/aio/deploy/recommended.yaml
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>To check if the installation was successful, run the <code>kubectl get pods -n kubernetes-dashboard</code> command, and confirm that the pods are running.</p> </div> </li> <li> <p>In a new terminal window start the <code>kubectl proxy</code>:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>kubectl proxy
</code></pre></div> </li> <li> <p>Launch a web browser and open the <a href=http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/ >Kubernetes Dashboard Login</a> page. Then, choose the <code>Kubeconfig</code> option, and provide your cluster's config file to log in.</p> <div class="admonition note"> <p class=admonition-title>Note<p>To get the config file navigate to your DigitalOcean cloud console, go to <code>Kubernetes</code>, select your cluster and from the <code>Configuration</code> section, click on <code>Download Config File</code>.</p> </p> </div> <p>After successfully logging in, you should be presented with the main dashboard landing page:</p> <p><a class=glightbox data-desc-position=bottom data-description data-height=auto data-title data-width=100% href=../../assets/kubernetes_dashboard_landing_page.png><img alt="kubernetes dashboard landing page" src=../../assets/kubernetes_dashboard_landing_page.png></a></p> </li> </ol> <p>Next, you can check metric summaries for each pod, node, and namespace in your cluster. Editing Kubernetes objects is also possible, such as scaling up/down deployments, change image version for pods, etc.</p> <p>Going further it is also possible to inspect log streams for pods. From the navigation bar at the top of the <code>Pods</code> view, click on the <code>Logs</code> tab to access a pod log stream directly in your web browser. In case of pods comprised of multiple containers, you have the option to inspect each container logs. Finally, you can <code>Exec</code> into a pod container from the same page.</p> <p>Kuberentes events are also viewable from the <code>Kubernetes Dashboard</code>. From the left menu click on the <code>Events</code> view. Events will be displayed and stored for 1 hour.</p> <p>Next, you will learn how to provision and configure the <code>staging</code> environment for the online boutique sample application. Besides DOKS setup and the sample app deployment, you will also configure a full observability stack comprised of logging, monitoring and alerting via Slack. Usually, a staging environment should be pretty close (if not similar) to a production environment.</p> </article> </div> </div> </main> <footer class=md-footer> <nav aria-label=Footer class="md-footer__inner md-grid"> <a aria-label="Previous: Set up ingress" class="md-footer__link md-footer__link--prev" href=../setup-ingress-dev/ rel=prev> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Set up ingress </div> </div> </a> <a aria-label="Next: Set up Staging DOKS" class="md-footer__link md-footer__link--next" href=../../03-staging/setup-doks-staging/ rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Set up Staging DOKS </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> DigitalOcean </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.d6c3db9e.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body> </html>